var j=(t,i,r)=>new Promise((a,n)=>{var l=s=>{try{m(r.next(s))}catch(o){n(o)}},x=s=>{try{m(r.throw(s))}catch(o){n(o)}},m=s=>s.done?a(s.value):Promise.resolve(s.value).then(l,x);m((r=r.apply(t,i)).next())});import{j as e,m as C,z as f}from"./ui-Dz3VGjCi.js";import{r as u}from"./vendor-DBl2kvvH.js";import{u as E}from"./useTelegramUser-BsW_Cs6Z.js";import{u as I,g as y,S as b,a as k,b as w,e as L}from"./index--vVcZAxM.js";import{u as z}from"./audioSettingsStore-U73_cNab.js";import{C as N}from"./Card-DwVsL2rV.js";function T({label:t,description:i,value:r,onChange:a}){return e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-content-primary",children:t}),e.jsx("div",{className:"text-sm font-mono text-audio-primary font-semibold",children:r.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r,onChange:n=>{k("light"),a(parseFloat(n.target.value))},className:`w-full h-1.5 rounded-full appearance-none cursor-pointer bg-white/10 accent-audio-primary
          [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5
          [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-audio-primary
          [&::-webkit-slider-thumb]:shadow-audio-neon [&::-webkit-slider-thumb]:border-2
          [&::-webkit-slider-thumb]:border-audio-primary-light`}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-[10px] text-content-tertiary",children:"0.0"}),e.jsx("span",{className:"text-[10px] text-content-tertiary",children:"1.0"})]}),e.jsx("p",{className:"text-xs text-content-tertiary mt-1",children:i})]})}function q(){const{t}=I("audio"),{telegramId:i,isLoading:r}=E(),{soundGenSettings:a,isLoading:n,isSaving:l,fetchSettings:x,updateSoundGen:m}=z(),[s,o]=u.useState(.7),[h,g]=u.useState(.7);u.useEffect(()=>{var d,p;const c=i||((p=(d=y())==null?void 0:d.id)==null?void 0:p.toString());c&&x(c)},[i]),u.useEffect(()=>{a&&(o(a.textTemp),g(a.waveformTemp))},[a]);const S=()=>j(this,null,function*(){var d,p;const c=i||((p=(d=y())==null?void 0:d.id)==null?void 0:p.toString());if(!c){f.error(t("saveError"));return}k("medium");try{yield m(c,{textTemp:s,waveformTemp:h}),w("success"),f.success(t("saved")),setTimeout(()=>L(),800)}catch(A){w("error"),f.error(t("saveError"))}});if(r||n)return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(b,{className:"h-16",variant:"rectangular"}),e.jsx(b,{className:"h-48",variant:"rectangular"}),e.jsx(b,{className:"h-24",variant:"rectangular"})]});const v=s!==(a==null?void 0:a.textTemp)||h!==(a==null?void 0:a.waveformTemp);return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("div",{className:"flex-1 p-4 pb-24",children:[e.jsx(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-5",children:e.jsxs("h1",{className:"text-xl font-display font-bold text-content-primary",children:[e.jsx("span",{className:"text-audio-primary",children:"ü•Å"})," ",t("soundSettings")]})}),e.jsxs(N,{className:"mb-4 !bg-audio-surface-card border border-white/5 p-4",children:[e.jsx(T,{label:t("textTemp"),description:t("textTempDesc"),value:s,onChange:o}),e.jsx(T,{label:t("waveformTemp"),description:t("waveformTempDesc"),value:h,onChange:g})]}),e.jsx(N,{className:"!bg-audio-surface-elevated border border-audio-primary/20 p-3.5",children:e.jsxs("div",{className:"flex",style:{columnGap:10},children:[e.jsx("span",{className:"text-audio-primary text-lg shrink-0",children:"üí°"}),e.jsx("p",{className:"text-xs text-content-secondary leading-relaxed",children:t("paramsInfo")})]})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-audio-surface via-audio-surface to-transparent pt-8",children:e.jsx("button",{onClick:S,disabled:!v||l,className:`w-full py-3 rounded-xl font-semibold text-sm transition-all ${v&&!l?"bg-audio-primary text-white shadow-audio-neon hover:bg-audio-primary-dark active:scale-[0.98]":"bg-white/5 text-content-tertiary cursor-not-allowed"}`,children:t(l?"saving":"save")})})]})}export{q as default};

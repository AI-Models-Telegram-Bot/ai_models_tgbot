import{j as e,m as o,A as N}from"./ui-Dz3VGjCi.js";import{r as g,b as w}from"./vendor-DBl2kvvH.js";import{u as k,P as y}from"./profileStore-8smoNdk7.js";import{c as p,u as f,h as B,g as C,B as P,S as c}from"./index--vVcZAxM.js";import{C as h}from"./Card-DwVsL2rV.js";import{u as L}from"./useTelegramUser-BsW_Cs6Z.js";const U={cyan:"bg-brand-primary/20 text-brand-primary",gray:"bg-surface-elevated text-content-tertiary",success:"bg-emerald-500/20 text-emerald-400",warning:"bg-yellow-500/20 text-yellow-400",error:"bg-red-500/20 text-red-400",gold:"bg-brand-accent/20 text-brand-accent",pink:"bg-brand-secondary/20 text-brand-secondary"},S=({children:t,variant:r="gray",className:a})=>e.jsx("span",{className:p("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",U[r],a),children:t});function u(t){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(Math.floor(t))}function M(t,r="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:2}).format(t)}const T=({wallet:t})=>{const{t:r}=f("profile"),[a,s]=g.useState(!1),n=t.textBalance+t.imageBalance+t.videoBalance+t.audioBalance,i=[{key:"text",icon:"ðŸ¤–",labelKey:"balances.text",value:t.textBalance,color:"bg-blue-500"},{key:"image",icon:"ðŸ–¼",labelKey:"balances.image",value:t.imageBalance,color:"bg-green-500"},{key:"video",icon:"ðŸŽ¬",labelKey:"balances.video",value:t.videoBalance,color:"bg-orange-500"},{key:"audio",icon:"ðŸŽµ",labelKey:"balances.audio",value:t.audioBalance,color:"bg-pink-500"}],x=Math.max(...i.map(l=>l.value),1);return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{B(),s(!a)},className:"text-right w-full group",children:[e.jsx("p",{className:"text-content-secondary text-sm uppercase tracking-wide",children:r("creditBalance")}),e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("p",{className:"text-white text-3xl font-bold tabular-nums",children:u(n)}),e.jsx(o.svg,{animate:{rotate:a?180:0},transition:{duration:.2},className:"w-4 h-4 text-content-secondary ml-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsx(N,{children:a&&e.jsx(o.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"overflow-hidden",children:e.jsxs("div",{className:"mt-3 space-y-2.5 pt-3 border-t border-white/10",children:[i.map((l,d)=>e.jsxs(o.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:d*.05},className:"flex items-center",children:[e.jsx("span",{className:"text-base text-center shrink-0 mr-2.5",style:{width:24},children:l.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:4},children:[e.jsx("span",{className:"text-content-secondary text-xs",children:r(l.labelKey)}),e.jsx("span",{className:"text-white text-sm font-semibold tabular-nums",children:u(l.value)})]}),e.jsx("div",{className:"bg-surface-elevated rounded-full overflow-hidden",style:{height:6},children:e.jsx(o.div,{className:p("h-full rounded-full",l.color),initial:{width:0},animate:{width:`${Math.max(l.value/x*100,2)}%`},transition:{duration:.4,delay:d*.05}})})]})]},l.key)),t.moneyBalance>0&&e.jsxs(o.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},className:"flex items-center pt-1",children:[e.jsx("span",{className:"text-base text-center shrink-0 mr-2.5",style:{width:24},children:"ðŸ’°"}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsx("span",{className:"text-content-secondary text-xs",children:r("balances.money")}),e.jsx("span",{className:"text-white text-sm font-semibold",children:M(t.moneyBalance,t.currency)})]})]})]})})})]})},E=({user:t,wallet:r})=>{var n;const a=t.firstName||t.username||"User",s=t.profilePhoto||((n=C())==null?void 0:n.photo_url);return e.jsx(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3},children:e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-full border-2 border-brand-primary/30 bg-surface-elevated flex items-center justify-center overflow-hidden shrink-0",style:{width:56,height:56,minWidth:56},children:s?e.jsx("img",{src:s,alt:a,width:56,height:56,className:"object-cover rounded-full",style:{width:56,height:56,display:"block"}}):e.jsx("span",{className:"text-xl font-bold text-brand-primary/70",children:a.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0 ml-3",children:[e.jsx("p",{className:"text-white text-lg font-semibold truncate",children:a}),t.username&&e.jsxs("p",{className:"text-content-secondary text-sm truncate",children:["@",t.username]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(T,{wallet:r})})]})})},F=({plan:t,onViewPlans:r})=>{const{t:a}=f("profile"),s=(t==null?void 0:t.name)||"Free",n=!t||t.tier==="FREE";return e.jsx(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3,delay:.1},children:e.jsxs(h,{variant:"bordered",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-content-tertiary text-xs uppercase tracking-wider font-medium",children:a("currentPlan")}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("p",{className:"text-white text-lg font-semibold",children:s}),!n&&e.jsx(S,{variant:"cyan",className:"ml-2",children:"Active"})]}),(t==null?void 0:t.expiresAt)&&e.jsxs("p",{className:"text-content-tertiary text-xs mt-1",children:["Expires: ",new Date(t.expiresAt).toLocaleDateString()]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-surface-elevated flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-content-tertiary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]}),e.jsx(P,{variant:"secondary",fullWidth:!0,className:"mt-4",onClick:r,children:n?a("viewPlans","View Plans"):a("managePlan","Manage Plan")})]})})},j=({label:t,icon:r,used:a,total:s,color:n})=>{const i=s===null,x=i?0:s>0?Math.min(a/s*100,100):0;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-base text-center shrink-0 mr-2.5",style:{width:24},children:r}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:4},children:[e.jsx("span",{className:"text-content-secondary text-xs",children:t}),e.jsx("span",{className:"text-white text-sm font-semibold tabular-nums font-mono",children:i?e.jsx("span",{className:"text-brand-accent",children:"Unlimited"}):e.jsxs(e.Fragment,{children:[u(a),"Â /Â ",u(s)]})})]}),!i&&e.jsx("div",{className:"bg-surface-elevated rounded-full overflow-hidden",style:{height:6},children:e.jsx("div",{className:p("h-full rounded-full transition-all duration-500",n),style:{width:`${Math.max(x,2)}%`}})}),i&&e.jsx("div",{className:"bg-brand-accent/20 rounded-full overflow-hidden",style:{height:6},children:e.jsx("div",{className:"h-full w-full bg-gradient-to-r from-brand-accent/40 to-brand-accent/60 rounded-full"})})]})]})},z=()=>{const{t}=f(),r=w(),{user:a,wallet:s,currentPlan:n,stats:i,isLoading:x,error:l,fetchUserProfile:d}=k(),{telegramId:m,isLoading:v,isTelegramEnv:b}=L();return g.useEffect(()=>{m&&d(m)},[d,m]),v?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(c,{className:"h-32 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-28 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-48 rounded-2xl",variant:"rectangular"})]}):!m&&!b?e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx(y,{}),e.jsxs("div",{className:"relative z-10 p-4 flex flex-col items-center justify-center min-h-[60vh] text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-brand-primary/10 flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsx("h2",{className:"text-white text-lg font-bold font-display mb-2",children:t("common:openInTelegram","Open in Telegram")}),e.jsx("p",{className:"text-content-secondary text-sm max-w-xs",children:t("common:openInTelegramDesc","This app is designed to be opened from the Telegram bot. Please open it via the bot menu or profile button.")})]})]}):x?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(c,{className:"h-32 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-28 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-48 rounded-2xl",variant:"rectangular"})]}):l?e.jsxs("div",{className:"p-4 flex flex-col items-center justify-center min-h-[60vh] text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("p",{className:"text-content-secondary text-sm",children:l}),e.jsx("button",{onClick:()=>m&&d(m),className:"mt-4 text-brand-primary text-sm font-medium",children:t("common:retry")})]}):!a||!s?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(c,{className:"h-32 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-28 rounded-2xl",variant:"rectangular"}),e.jsx(c,{className:"h-48 rounded-2xl",variant:"rectangular"})]}):e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx(y,{}),e.jsxs("div",{className:"relative z-10 p-4 space-y-5",children:[e.jsx(E,{user:a,wallet:s}),e.jsx(F,{plan:n,onViewPlans:()=>r("/")}),n&&e.jsx(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3,delay:.2},children:e.jsxs(h,{children:[e.jsx("h3",{className:"text-sm font-medium text-content-tertiary uppercase tracking-wider mb-3",children:t("profile:creditUsage","Credit Usage")}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{label:"Text",icon:"ðŸ¤–",used:s.textBalance,total:n.credits.text,color:"bg-cyan-500"}),e.jsx(j,{label:"Image",icon:"ðŸ–¼",used:s.imageBalance,total:n.credits.image,color:"bg-pink-500"}),e.jsx(j,{label:"Video",icon:"ðŸŽ¬",used:s.videoBalance,total:n.credits.video,color:"bg-purple-500"}),e.jsx(j,{label:"Audio",icon:"ðŸŽµ",used:s.audioBalance,total:n.credits.audio,color:"bg-emerald-500"})]})]})}),i&&e.jsx(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3,delay:.3},children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(h,{padding:"sm",children:[e.jsx("p",{className:"text-content-tertiary text-xs uppercase tracking-wider",children:t("profile:totalRequests","Requests")}),e.jsx("p",{className:"text-white text-xl font-bold font-mono mt-1",children:u(i.totalRequests)})]}),e.jsxs(h,{padding:"sm",children:[e.jsx("p",{className:"text-content-tertiary text-xs uppercase tracking-wider",children:t("profile:totalSpent","Total Spent")}),e.jsxs("p",{className:"text-white text-xl font-bold font-mono mt-1",children:["$",i.totalSpent.toFixed(2)]})]})]})})]})]})};export{z as default};
